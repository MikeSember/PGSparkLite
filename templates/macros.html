{% macro onoff_buttons(effect_id, state) %}
<div class="onoff_buttons">
    <button data-id="{{ effect_id }}" id="{{ effect_id }}_on"
        class="onoff_button {% if state == 'On' %} selected {% endif %}" value="On" type="submit">ON</button>
    <button data-id="{{ effect_id }}" id="{{ effect_id }}_off"
        class="onoff_button {% if state == 'Off' %} selected {% endif %}" value="Off" type="submit">OFF</button>
</div>
{% endmacro %}

{% macro effect_selector(effect_type, effects, effect_selected) %}
<select class="effect-selector" data-type="{{ effect_type }}" data-selected="{{ effect_selected }}"
    id="{{ effect_type }}_selector">
    {% for id, effect in effects.items() %}
    <option value="{{ id }}" {% if id==effect_selected %} selected {% endif %}>{{ effect["name"] }}</option>
    {% endfor %}
</select>
{% endmacro %}

{% macro effect_parameters(effect_id, parameters, parameter_values, knob, knob_diameter) %}
{% for parameter in parameters %}
<div class="parameter" style="width:{{ parameter.width }}%;">    
    {% if parameter.switch == "true" %}
    <div class="parameter_value">      
        {% if parameter.name %}
        <span>{{ parameter.name }}</span><br/>
        {% endif %}
        <span>{{ parameter.on }}</span><br/>
        <input data-parameter="{{ parameter.id }}" class="input-switch" data-src="./img/knobs/switch_offon.png" data-diameter="50" data-id="{{ effect_id }}" type="checkbox" {% if parameter_values[parameter.id] == 1.0000 %} checked {% endif %}/><br/>
        <span>{{ parameter.off }}</span>
    </div>
    {% else %}
    <div class="parameter_value">        
        <input class="input-knob" type="range" data-parameter="{{ parameter.id }}" data-id="{{ effect_id }}" data-diameter="{{ knob_diameter }}" data-src="./img/knobs/{{ knob }}.png" data-sprites="100"
            id="{{ effect_id }}_{{ parameter.id }}" min="0.0000" max="1" step="0.0001"
            value="{{ parameter_values[parameter.id] }}" />        
    </div>
    <div class="parameter_label">
        {{ parameter.name }}
    </div>    
    {% endif %}
</div>
{% endfor %}
{% endmacro %}

{% macro effect_container(type, effect, effect_list, selector) %}
{% set effect_config = effect_list[effect["Name"]] %}
{% set background_color = effect_config["background-color"] %}
{% set color = effect_config["color"] %}
{% set knob = effect_config["knob"] %}
{% set knob_diameter = effect_config["knob-diameter"] %}
<div class="effect_header">
    <div class="effect_title">
        {{ type }}
    </div>    
    {% if selector %}
        {{ effect_selector(type, effect_list, effect["Name"]) }}
    {% else %}
    <div class="effect_selector"></div>
    {% endif %}
    <div class="effect_onoff">
        {{ onoff_buttons(effect["Name"], effect["OnOff"]) }}
    </div>    
</div>
<div id="{{ effect_id }}_content" class="effect_content" style="background-color:{{ background_color }}; color:{{ color }};">
    <div class="effect_parameters">
        {{ effect_parameters(effect["Name"], effect_config["parameters"], effect["Parameters"], knob, knob_diameter)}}
    </div>
</div>
{% endmacro %}